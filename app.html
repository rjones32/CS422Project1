<!DOCTYPE html>    
<head>
    <meta charset="utf-8">
    <title>fabric.js project template</title>
	
	<!-- Get version 1.5.0 of Fabric.js from CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.5.0/fabric.min.js" ></script>
 <style>
    .button{
        background-color: #4CAF50; /* Green */
        border: none;
        color: white;
        width:5%;
        height:200px;
        float: right;
        padding: 15px 32px;
        margin: 4px 10px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 60px;
    }


 </style>

	 
<body>
		<!-- canvas tag for Fabric.js to draw into -->
		<canvas id="c" width="4140" height="2200" style="border:2px solid black;" ></canvas>

</body>

<button type="button" class="button" id="button1">unplugged</button>
<button type="bath" class="button" id="button2">bath</button>
 
<script>

// within the code below I assume I am drawing into a 1860x990 box
// then I can scale the group to whatever size the final canvas is
// in this case 4140 x 2200 for the wall
// you should pick an appropriate local size and canvas size that are easy for you to work with

  var temperature = 0;
  var waterCheck = 0;
  var isPlugged = false;
  var diverter = false;
  var pressure = 0;
  var isChild = false;
  var waterLevel = 0;
  var isSet = false;
  var isBath = false;
  var isCelsius = false;
  var prefIndex;
  var tempText;
  var tempText2;
  var pressText2;
  var userTypeText;
  var usageText;
  var saveText;
  var runText;
  var profiles = [];
  var png = ".png";
  var tempType = ["F","C"];
  var tempIndex = 0;
  var tempDisp;
  var prefIndex;
  var divButt;
  var divButt2;
  var hotArrow;
  var coldArrow;
  var pressDisp;
  var incPressButton;
  var decPressButton;
  var button3;
  var button4;
  var button6;
  var menu = [];
  var divIndex = 3;
  var menuIndex = 0;
  var users;
  var back;
  var gear;
  var menuScreen;
  var menuText;
  var menuText2;
  var menuText3;
  var menuText4;
  var menuText5;
  var menuText6;
  var menuText7;
  var menuIndex = 0;
  var langSetting, Langsetting2;
  var languages = [];
  var lIndex = 0;
  var nextLang = 0;
  var button,button2;
  var nextArrow,prevArrow;
  var userIndex;

  /*for(i=0;i<5;i++){
          profiles.push({name: "User", id: (i + 1), temp: 0, isChild: false, bath: false, press: 0, lang: 0});
  */

   for(i=0;i<2;i++) {
       var prefences = [];
       profiles.push({name: "User", id: (i+1), pref: prefences});
       for (j = 0; j < 5; j++) {
           if(j==0) {
               profiles[i].pref.push({temp: 0, isChild: false, bath: false, press: 0, lang: 0});
           }
           else if(j==1){
               profiles[i].pref.push({temp: 80, isChild: false, bath: true, press: 15, lang: 0});
           }
           else if(j==2){
               profiles[i].pref.push({temp: 75, isChild: false, bath: false, press: 15, lang: 0});
           }
           else if(j==3){
               profiles[i].pref.push({temp: 60, isChild: false, bath: true, press: 20, lang: 0});
           }
           else if(j==4){
               profiles[i].pref.push({temp: 55, isChild: false, bath: false, press: 15, lang: 0});
           }
       }
   }


//  profiles[1].name="Ryan",profiles[1].temp=80,profiles[1].press=10;


  for(i=0;i<11;i++){
      languages[i] = [];
      for(j=0;j<17;j++){
          languages[i][j]="a";
      }
  }

  languages[0][0]="English";
  languages[0][1]="Users";
  languages[0][2]="Settings";
  languages[0][3]="Languages";
  languages[0][4]="Scale Type";
  languages[0][5]="User";
  languages[0][6]="Temperature";
  languages[0][7]="Pressure";
  languages[0][8]="User Type";
  languages[0][9]="Usage";
  languages[0][10]="Adult";
  languages[0][11]="Child";
  languages[0][12]="Bath";
  languages[0][13]="Shower";
  languages[0][14]="Setup";
  languages[0][15]="Start";
  languages[0][16]="Save";
  languages[1][0]="français";
  languages[1][1]="utilisateurs";
  languages[1][2]="paramètres";
  languages[1][3]="Langues";
  languages[1][4]="Type d' échelle";
  languages[1][5]="utilisateur";
  languages[1][6]="Température";
  languages[1][7]="Pression";
  languages[1][8]="utilisateur Type";
  languages[1][9]="Usage";
  languages[1][10]="Adulte";
  languages[1][11]="Enfant";
  languages[1][12]="Bain";
  languages[1][13]="Douche";
  languages[1][14]="Installer";
  languages[1][15]="Début";
  languages[1][16]="enregistrer";
  languages[2][0]= "español";
  languages[3][0]= "Deutsch";
  languages[4][0]= "flemish";
  languages[5][0]= "português";
  languages[6][0]= "普通话";
  languages[7][0]= "日本語";
  languages[8][0]= "العَرَبِية";
  languages[9][0]= "עברית";
  languages[10][0]= "português";





(function() {

  var localHeight = 990;
  var localWidth = 1860;

  var canvas = this.__canvas = new fabric.Canvas('c');

  canvas.backgroundColor = "#5555F5"; // background blue to help find it
  //fabric.Object.prototype.transparentCorners = false;

  canvas.renderOnAddRemove=false;

/*
  canvas.on('mouse:over', function(e) {
    console.log(e.target);
    //canvas.renderAll();
  });

  canvas.on('mouse:out', function(e) {
    console.log(e.target);
    //canvas.renderAll();
  });
*/

var backWall = new fabric.Rect({
  left: 0,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 450,
  height: localHeight,
  angle: 0
});
backWall.hasControls = backWall.hasBorders = false;
backWall.lockMovementX = backWall.lockMovementY = true;

var sideWall = new fabric.Rect({
  left: 450,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 960,
  height: localHeight,
  angle: 0
});
sideWall.hasControls = sideWall.hasBorders = false;
sideWall.lockMovementX = sideWall.lockMovementY = true;

var frontWall = new fabric.Rect({
  left: 1410,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 450,
  height: localHeight,
  angle: 0
});
frontWall.hasControls = frontWall.hasBorders = false;
frontWall.lockMovementX = frontWall.lockMovementY = true;

var bathSpout = new fabric.Rect({
  left: 1635,
  top: 950,
  originX: 'center',
  originY: 'center',
  fill: 'grey',
  stroke: 'black',
  width: 60,
  height: 30,
  angle: 0
});

bathSpout.hasControls = bathSpout.hasBorders = false;
bathSpout.lockMovementX = bathSpout.lockMovementY = true;

// this lets me 'select' it but I cant keep clicking on it more than once


var showerHead = new fabric.Circle({
  radius: 20, fill: 'black', left: 1635, top: 100,   originX: 'center',
  originY: 'center'
});


    canvas.add(backWall);
    canvas.add(sideWall);
    canvas.add(frontWall);
    canvas.add(showerHead);
    canvas.add(bathSpout);



    tempText = new fabric.Text('0'+tempType[tempIndex], { left: 1755, top: 545, fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
  originY: 'top',});

tempText.hasControls = tempText.hasBorders = false;
tempText.lockMovementX = tempText.lockMovementY = false;
tempText.selectable = false;

var degree = new fabric.Text('o', { left: 1770, top: 530, fontFamily: 'Arial', fontSize: 20, fontWeight: 'italic', originX: 'top', originY: 'top',});

    degree.hasControls = degree.hasBorders = false;
    degree.lockMovementX = degree.lockMovementY = false;
    degree.selectable = false;

    var pressText = new fabric.Text('0', { left: 1525, top: 545, fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',});

    pressText.hasControls = pressText.hasBorders = false;
    pressText.lockMovementX = pressText.lockMovementY = false;
    pressText.selectable = false;


    var psi = new fabric.Text('psi', { left: 1555, top: 545, fontFamily: 'Arial', fontSize: 20, fontWeight: 'italic', originX: 'top',
        originY: 'top',});

    psi.hasControls = psi.hasBorders = false;
    psi.lockMovementX = psi.lockMovementY = false;
    psi.selectable = false;

    tempText2 = new fabric.Text('0', { left: 1750, top: 260, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    tempText2.hasControls = tempText2.hasBorders = false;
    tempText2.lockMovementX = tempText2.lockMovementY = false;
    tempText2.selectable = false;

    pressText2 = new fabric.Text('0', { left: 1750, top: 360, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    pressText2.hasControls = pressText2.hasBorders = false;
    pressText2.lockMovementX = pressText2.lockMovementY = false;
    pressText2.selectable = false;

    usageText = new fabric.Text('Bath', { left: 1510, top: 260, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    usageText.hasControls = usageText.hasBorders = false;
    usageText.lockMovementX = usageText.lockMovementY = false;
    usageText.selectable = false;

    userTypeText = new fabric.Text('Adult', { left: 1510, top:360, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    userTypeText.hasControls = userTypeText.hasBorders = false;
    userTypeText.lockMovementX = userTypeText.lockMovementY = false;
    userTypeText.selectable = false;

    runText = new fabric.Text('Select', { left: 1650, top:410, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    runText.hasControls = runText.hasBorders = false;
    runText.lockMovementX = runText.lockMovementY = false;
    runText.selectable = false;

    saveText = new fabric.Text('Save', { left: 1800, top:460, fontFamily: 'Arial',fill:"white", fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    saveText.hasControls = saveText.hasBorders = false;
    saveText.lockMovementX = saveText.lockMovementY = false;
    saveText.selectable = false;

    var plusText = new fabric.Text('+', { left: 1470, top:410, fontFamily: 'Arial',fill:"white", fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    plusText.hasControls = saveText.hasBorders = false;
    plusText.lockMovementX = saveText.lockMovementY = false;
    plusText.selectable = false;




    //tempText.selectable = false;

var waterControl = new fabric.Circle({
  left: 1500,
  top: 90,
  originX: 'center',
  originY: 'center',
  fill: 'grey',
  radius: 50
});



//-------------------------------------------------------------------------------------------------------------------
//---------------------------------------------------My code---------------------------------------------------------
    var waterMonitor;
    var waterLevel = 0;
    var drain = false;

    $(document).ready(function(){
        $("#button1").click(function(){
            if(drain==true) {
                drain = false;
                $("#button1").text("plugged!");
            }
            else{
                drain= true;
                $("#button1").text("unplugged!");

            }
        });
    });



    $(document).ready(function(){
        $("#button2").click(function(){
            if(isBath==true) {
                isBath = false;
                mainControls();
                $("#button2").text("shower");
            }
            else{
                isBath= true;
                mainControls();
                $("#button2").text("bath");

            }
        });
    });



    fabric.Image.fromURL('L'+0+png, function(img6) {
        waterMonitor=img6.scale(.5).set({
            left: 3950,
            top: 1550,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img6).setActiveObject(img6);
    });

    function incWater(){
        console.log("water levels");
        if(drain==false&&pressure>0&&temperature>0) {
            if (waterLevel == 35) {
                waterLevel = 35;
            }
            else {
                waterLevel = waterLevel + 5;
            }

        }
        else if(drain==true){
            if(waterLevel==0){
                waterLevel=0
            }
            else{
                waterLevel = waterLevel-5;
            }

        }
        if(waterCheck!=waterLevel) {
            if (isBath == false) {
                fabric.Image.fromURL('L' + waterLevel + png, function (img6) {
                    var temp = img6.scale(.5).set({
                        left: 3950,
                        top: 1550,
                        lockMovementX: true,
                        lockMovementY: true,
                        lockRotation: true,
                        lockScalingX: true,
                        lockScalingY: true,
                        originX: 'center',
                        originY: 'center',
                        visible: true
                    });
                    canvas.remove(waterMonitor);
                    waterMonitor = temp;
                    canvas.add(waterMonitor).setActiveObject(waterMonitor);
                });
                waterCheck = waterLevel;
            }
        }
        else{
            mainControls();
        }


    }

    function tempInc(){

        var temp;

        if(temperature==0){
            temperature=70;
        }
        else if(temperature==65){
            temperature=0;
        }
        else if (temperature>=95){
            temperature=95;
        }
        else{
            temperature = temperature + 5;
        }
        console.log("Increasing temperature");

        if(isBath==false){

        fabric.Image.fromURL(temperature+png, function(img) {
            temp=img.scale(.5).set({
                left: 3900,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(tempDisp);
            tempDisp = temp;
            canvas.add(img).setActiveObject(img);
            tempText.bringToFront();
            degree.bringToFront();
        });}
        else {
            mainControls();
        }
        if(tempIndex==1&&temperature!=0){
            var celsius = (temperature-32)*5/9;
            celsius = Math.floor(celsius);
            tempText.text=celsius.toString()+tempType[tempIndex];
        }
        else {
            tempText.text = temperature.toString() + tempType[tempIndex];
        }
        if(menuIndex==6){
            tempText2.text = tempText.text;
        }
        waterFlow();

    }


    function tempDec(){
        var temp;

        if(temperature==0){
            temperature=65;
        }
        else if(temperature==70){
            temperature = 0;
        }
        else if(temperature<=40){
            temperature = 40;
        }
        else{
            temperature = temperature - 5;
        }
        console.log("Deceasing Temperature");
        if(isBath==false) {

            fabric.Image.fromURL(temperature + png, function (img) {
                temp = img.scale(.5).set({
                    left: 3900,
                    top: 1250,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(tempDisp);
                tempDisp = temp;

                canvas.add(img).setActiveObject(img);
                tempText.bringToFront();
                tempText.bringToFront();
                degree.bringToFront();

                /*if (tempIndex == 1 && temperature != 0) {

                    var celsius = (temperature - 32) * 5 / 9;
                    celsius = Math.floor(celsius);
                    tempText.text = celsius.toString() + tempType[tempIndex];
                }
                else {
                    tempText.text = temperature.toString() + tempType[tempIndex];
                }*/

            });
        }
        else{
            mainControls();
        }
        if (tempIndex == 1 && temperature != 0) {

            var celsius = (temperature - 32) * 5 / 9;
            celsius = Math.floor(celsius);
            tempText.text = celsius.toString() + tempType[tempIndex];
        }
        else {
            tempText.text = temperature.toString() + tempType[tempIndex];
        }
        if(menuIndex==6){
            tempText2.text = tempText.text;
        }
        waterFlow();


    }

    function tempSet(){

        var temp;
        fabric.Image.fromURL(temperature+png, function(img) {
            temp=img.scale(.5).set({
                left: 3900,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(tempDisp);
            tempDisp = temp;
            canvas.add(img).setActiveObject(img);
            tempText.bringToFront();
            degree.bringToFront();
        });
        tempText.text=temperature.toString()+tempType[tempIndex];
        waterFlow();
    }

    function divButton(){
        var temp;

        if(diverter==false){
            console.log("diverter is false");
            /*fabric.Image.fromURL('diverter'+divIndex+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);

                img5.on('selected',function(){
                    divButton();
                })

                img5.bringToFront();
                divButt2 = temp;
                divIndex--;
            });*/
            isBath = false;
            divIndex=3;
            mainControls();

            diverter = true;
            if(menuIndex==6){
                usageText.text = languages[lIndex][13]
            }


        }
        else if(diverter==true){

           /* console.log("diverter is true");
            fabric.Image.fromURL('diverter'+divIndex+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);
                img5.on('selected',function(){
                    divButton();
                })
                img5.bringToFront();
                divButt2 = temp;
            });*/
            isBath =true;
            divIndex = 2;
            mainControls();
            diverter = false;
            if(menuIndex==6){
                usageText.text = languages[lIndex][12]
            }
        }
        waterFlow();
    }

    function incPress(){

        var temp;

        if(pressure<25){
            pressure=pressure+5;
        }
        else{
            pressure = 25;
        }
        console.log("Increasing pressure");

        if(isBath==false) {
            fabric.Image.fromURL('p' + pressure + png, function (img6) {
                temp = img6.scale(.5).set({
                    left: 3400,
                    top: 1250,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(pressDisp);
                pressDisp = temp;
                canvas.add(img6).setActiveObject(img6);
                pressText.bringToFront();
                psi.bringToFront();

            });
        }
        else{
            mainControls();
        }
        pressText.text = pressure.toString();
        if(menuIndex==6){
            console.log("setting pressure text 2");
            pressText2.text = pressText.text;
        }
        waterFlow();

    }


    function decPress(){
        var temp;

        if(pressure>0){
            pressure=pressure-5;
        }
        else {
            pressure = 0;
        }

        console.log("Deceasing pressure");
        if(isBath==false) {
            fabric.Image.fromURL('p' + pressure + png, function (img6) {
                temp = img6.scale(.5).set({
                    left: 3400,
                    top: 1250,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(pressDisp);
                pressDisp = temp;

                canvas.add(img6).setActiveObject(img6);
                pressText.bringToFront();
                psi.bringToFront();


            });
        }
        else{
            mainControls();
        }
        pressText.text = pressure.toString();


        if (menuIndex == 6) {
            pressText2.text = pressText.text;
        }
        waterFlow();

    }


    function setSettings(){
        if(isBath==false) {
            fabric.Image.fromURL('p' + pressure + png, function (img6) {
                temp = img6.scale(.5).set({
                    left: 3400,
                    top: 1250,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(pressDisp);

                canvas.add(img6).setActiveObject(img6);

                pressText.bringToFront();
                psi.bringToFront();

            });

            fabric.Image.fromURL(temperature+png, function(img) {
                temp=img.scale(.5).set({
                    left: 3900,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(tempDisp);
                tempDisp = temp;
                canvas.add(img).setActiveObject(img);
                tempText.bringToFront();
                degree.bringToFront();
            });

        }
        else{
            mainControls()
        }
        pressDisp = temp;
        tempText.text=temperature.toString()+tempType[tempIndex];
        pressText.text = pressure.toString();

        waterFlow();


    }
    function waterFlow(){
        if(pressure>0&&temperature>0){
            if(isBath==true){
                showerHead.fill="grey";
                bathSpout.fill="blue";
            }
            else if(isBath==false){
                showerHead.fill="blue";
                bathSpout.fill="grey";
            }
        }
        else{
            bathSpout.fill="grey";
            showerHead.fill="grey";
        }
    }

//-----------------------------------------------------------------------------------------------------------------
//----------------------------------Menu text------------------------------------------------------------------------



    button = new fabric.Rect({
        left: 1650,
        top: 300,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 220,
        height: 50,
        angle: 0,
        visible:false

    });


    button.lockMovementX= button.lockMovementY = true;


    button2 = new fabric.Rect({
        left: 1650,
        top: 370,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 220,
        height: 50,
        angle: 0,
        visible:false
    });
    button2.lockMovementX=button2.lockMovementY=true;

    button3 = new fabric.Rect({
        left: 1650,
        top: 430,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 220,
        height: 40,
        angle: 0,
        visible:false
    });
    button3.lockMovementX=button3.lockMovementY=true;

    button4 = new fabric.Rect({
        left: 1525,
        top: 380,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 150,
        height: 35,
        angle: 0,
        visible:false
    });
    button4.lockMovementX=button4.lockMovementY=true;

    button6 = new fabric.Rect({
        left: 1470,
        top: 430,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 100,
        height: 40,
        angle: 0,
        visible:false
    });
    button6.lockMovementX=button6.lockMovementY=true;


    nextArrow = new fabric.Triangle({
        left: 1790,
        top: 310,
        originX: 'center',
        originY: 'center',
        fill: 'white',
        stroke: 'black',
        lockMovementX: true,
        lockMovementY: true,
        hasControls: false,
        hasBorders:false,
        width: 150,
        height: 50,
        angle: 90,
        visible:false
    });
    /*nextArrow.lockMovementX=nextArrow.lockMovementY=true;
    nextArrow.hasBorders = nextArrow.hasControls = false;*/
    nextArrow.on('selected',function(){
        if(menuIndex==4) {
            if (userIndex == (profiles.length-1)) {
                userIndex = 0;
            }
            else {
                userIndex++;
            }

            if (profiles[userIndex].name != "User") {
                menuText2.text = profiles[userIndex].name + profiles[userIndex].id;
            }
            else {
                menuText2.text = languages[lIndex][5] + profiles[userIndex].id;
            }
            canvas.deactivateAll();
        }
        else if(menuIndex==2){
            if(nextLang>10){
                nextLang=0;
                menuText3.text = languages[nextLang+1][0];
                menuText4.text = languages[nextLang][0] ;
            }
            else if(nextLang==8){
                nextLang = 10;
                menuText3.text = " ";
                menuText4.text = languages[nextLang][0];
            }
            else {
                nextLang = nextLang + 2;
                menuText3.text = languages[nextLang+1][0];
                menuText4.text = languages[nextLang][0];
            }



        }
        canvas.deactivateAll();

    })



    prevArrow = new fabric.Triangle({
        left: 1490,
        top: 310,
        originX: 'center',
        originY: 'center',
        fill: 'white',
        stroke: 'black',
        lockMovementX: true,
        lockMovementY: true,
        hasControls: false,
        hasBorders:false,
        width: 150,
        height: 50,
        angle: 270,
        visible:false
    });
    //prevArrow.lockMovementX=prevArrow.lockMovementY=true;
    //prevArrow.hasControls = prevArrow.hasBorders = false;

    prevArrow.on('selected',function(){
        if(menuIndex==4) {
            if (userIndex == 0) {
                userIndex = (profiles.length-1);
            }
            else {
                userIndex--;
            }

            if (profiles[userIndex].name != "User") {
                menuText2.text = profiles[userIndex].name + profiles[userIndex].id;
            }
            else {
                menuText2.text = languages[lIndex][5] + profiles[userIndex].id;
            }
        }
        else if(menuIndex==2){
            if(nextLang==0){
                nextLang=10;
                menuText3.text = " ";
                menuText4.text = languages[nextLang][0] ;
            }
            else {
                nextLang = nextLang - 2;
                menuText3.text = languages[nextLang+1][0];
                menuText4.text = languages[nextLang][0];
            }
        }
        canvas.deactivateAll();
    })




    var nextArrow2 = new fabric.Triangle({
        left: 1790,
        top: 430,
        originX: 'center',
        originY: 'center',
        fill: 'white',
        stroke: 'black',
        lockMovementX: true,
        lockMovementY: true,
        hasControls: false,
        hasBorders:false,
        width: 50,
        height: 20,
        angle: 90,
        visible:false
    });
    /*nextArrow.lockMovementX=nextArrow.lockMovementY=true;
     nextArrow.hasBorders = nextArrow.hasControls = false;*/
    nextArrow2.on('selected',function(){

        if((profiles[userIndex].pref.length-1)==prefIndex)
          prefIndex=0;
        else
          prefIndex++;


            if (profiles[userIndex].pref[prefIndex].isChild == false) {
                userTypeText.text = languages[lIndex][10];
            }
            else {
                userTypeText.text = languages[lIndex][11];
            }

            if (profiles[userIndex].pref[prefIndex].bath == false) {
                usageText.text = languages[lIndex][12];
            }
            else {
                usageText.text = languages[lIndex][13];
            }

            menuText2.text = (prefIndex+1).toString();
            tempText2.text = profiles[userIndex].pref[prefIndex].temp + tempType[tempIndex];
            pressText2.text = profiles[userIndex].pref[prefIndex].press + "psi";
        canvas.deactivateAll();



    })



    var prevArrow2 = new fabric.Triangle({
        left: 1510,
        top: 430,
        originX: 'center',
        originY: 'center',
        fill: 'white',
        stroke: 'black',
        lockMovementX: true,
        lockMovementY: true,
        hasControls: false,
        hasBorders:false,
        width: 50,
        height: 20,
        angle: 270,
        visible:false
    });
    //prevArrow.lockMovementX=prevArrow.lockMovementY=true;
    //prevArrow.hasControls = prevArrow.hasBorders = false;

    prevArrow2.on('selected',function(){


        if(prefIndex==0)
            prefIndex=(profiles[userIndex].pref.length-1);
        else
            prefIndex--;

        if(menuIndex==5) {
            if (profiles[userIndex].pref[prefIndex].isChild == false) {
                userTypeText.text = languages[lIndex][10];
            }
            else {
                userTypeText.text = languages[lIndex][11];
            }

            if (profiles[userIndex].pref[prefIndex].bath == false) {
                usageText.text = languages[lIndex][12];
            }
            else {
                usageText.text = languages[lIndex][13];
            }

            menuText2.text = (prefIndex+1).toString();
            tempText2.text = profiles[userIndex].pref[prefIndex].temp + tempType[tempIndex];
            pressText2.text = profiles[userIndex].pref[prefIndex].press + "psi";
        }
        canvas.deactivateAll();

    })



    menuText3= new fabric.Text(languages[lIndex][3], {left:1655, top:340,fill:'white', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText3.selectable = false;
    menuText3.evented = false;
    menuText3.lockMovementX = menuText3.lockMovementY = true;




    menuText4 = new fabric.Text(languages[lIndex][4], {left:1655,top:280,fontFamily: 'Arial',fill:'white', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText4.selectable = false;
    menuText4.evented = false;
    menuText4.lockMovementX = menuText4.lockMovementY = true;




    menuText = new fabric.Text(languages[lIndex][1], {left:1725, top:400,fill:'white', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText.selectable = false;
    menuText.evented = false;
    menuText.lockMovementX = menuText.lockMovementY = true;


    menuText2 = new fabric.Text(languages[lIndex][2], {left:1525,top:400,fontFamily: 'Arial',fill:'white', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText2.selectable = false;
    menuText2.evented = false;
    menuText2.lockMovementX = menuText2.lockMovementY = true;


    menuText5 = new fabric.Text(languages[lIndex][2], {left:1510,top:320,fontFamily: 'Arial',fill:'white', fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText5.selectable = false;
    menuText5.evented = false;
    menuText5.lockMovementX = menuText5.lockMovementY = true;

    menuText6 = new fabric.Text(languages[lIndex][2], {left:1750,top:320,fontFamily: 'Arial',fill:'white', fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText6.selectable = false;
    menuText6.evented = false;
    menuText6.lockMovementX = menuText6.lockMovementY = true;

    menuText7 = new fabric.Text(languages[lIndex][2], {left:1750,top:220,fontFamily: 'Arial',fill:'white', fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText7.selectable = false;
    menuText7.evented = false;
    menuText7.lockMovementX = menuText7.lockMovementY = true;

    var menuText8 = new fabric.IText('User',{left:1650,top:180,fontFamily: 'Arial',fill:'green', fontSize: 34, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false,editable:true});

    menuText8.selectable = false;
    menuText8.evented = false;
    menuText8.lockMovementX = menuText8.lockMovementY = true;


//-----------------------------------------------------------------------------------------------------------------
//----------------------------------My Code------------------------------------------------------------------------

    var back = new fabric.Triangle({
        left: 1450,
        top: 210,
        originX: 'center',
        originY: 'center',
        fill: 'white',
        stroke: 'black',
        lockMovementX: true,
        lockMovementY: true,
        hasControls: false,
        hasBorders:false,
        width: 50,
        height: 50,
        angle: 270,
        visible:false
    });


    back.on('selected',function(){

        if(menuIndex==1) {
            back.setVisible(false);
            gear.setVisible(true);
            users.setVisible(true);
            menuText3.setVisible(false);
            menuText4.setVisible(false);
            button.setVisible(false);
            button2.setVisible(false);
            menuIndex=0;
            canvas.deactivateAll();
            menu1();
        }

        else if(menuIndex==2){
            menuIndex=1;
            nextArrow.visible = false;
            prevArrow.visible = false;
            settingMenu();
        }
        else if(menuIndex==3){
            menuIndex=1;
            canvas.deactivateAll();
            settingMenu();
        }

        else if(menuIndex==4){
            back.setVisible(false);
            gear.visible=true;
            users.visible = true;
            users2.visible = false;
            button3.visible = false;
            button4.visible = false;
            button6.visible = false;
            plusText.visible= false;
            prevArrow.visible = false;
            nextArrow.visible = false;
            runText.visible = false;
            menuText2.left=3375;
            menuText2.top = 900;
            menuIndex=0;
            canvas.deactivateAll();
            menu1();
        }
        else if(menuIndex==5){
            prevArrow.Visible = true;
            nextArrow.visible = true;
            nextArrow2.visible=false;
            prevArrow2.visible=false;
            users2.visible = true;
            menuText.visible = false;
            menuText5.visible = false;
            menuText6.visible = false;
            menuText7.visible = false;
            tempText2.visible = false;
            pressText2.visible = false;
            menuText.top = 900;
            menuText.left = 3875;
            menuText.fontSize = 40;
            userTypeText.visible = false;
            usageText.visible = false;
            menuIndex=4;
            canvas.deactivateAll();
            userMenu();
        }
        else if(menuIndex==6){
            button4.visible=false;
            prevArrow.Visible = true;
            nextArrow.visible = true;
            users2.visible = true;
            nextArrow2.visible=false;
            prevArrow2.visible=false;
            menuText.visible = false;
            menuText5.visible = false;
            menuText6.visible = false;
            menuText7.visible = false;
            menuText8.visible = false;
            tempText2.visible = false;
            pressText2.visible = false;
            menuText.top = 900;
            menuText.left = 3875;
            menuText.fontSize = 40;
            userTypeText.visible = false;
            usageText.visible = false;
            menuIndex=4;
            canvas.deactivateAll();
            userMenu();
        }
    })




    fabric.Image.fromURL('0'+png, function(img) {
        tempDisp=img.scale(.5).set({
            left: 3900,
            top: 1250,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:false,
            lockMovementY:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });
         canvas.add(img);
        tempText.bringToFront();
        degree.bringToFront();
    });

   fabric.Image.fromURL('hot-arrow.png', function(img2) {
        hotArrow=img2.scale(.5).set({
            _uid:1,
            left: 3750,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });

       hotArrow.on('selected', function() {
           tempInc();
           canvas.deactivateAll();

        });
        canvas.add(hotArrow);
       tempText.bringToFront();

    });

    fabric.Image.fromURL('cold-arrow.png', function(img3) {
        coldArrow=img3.scale(.5).set({
            _uid:2,
            left: 4050,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            hasControls:false,
            hasBorders:false,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });
        coldArrow.on('selected', function() {
           tempDec()});
        canvas.deactivateAll();

        canvas.add(coldArrow);
    });

    fabric.Image.fromURL('diverter1'+png, function(img4) {
        divButt=img4.scale(.4).set({
            left: 3650,
            top: 1500,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img4);
    });

    fabric.Image.fromURL('diverter'+divIndex+png, function(img5) {
        divButt2=img5.scale(.4).set({
            left: 3650,
            top: 1500,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img5);
        img5.bringToFront();
        img5.on('selected',function(){
            divButton();
            canvas.deactivateAll();

        })
    });


    fabric.Image.fromURL('p0'+png, function(img6) {
        pressDisp=img6.scale(.5).set({
            left: 3400,
            top: 1250,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img6).setActiveObject(img6);
       pressText.bringToFront();
        psi.bringToFront();

    });

    fabric.Image.fromURL('incPress.png', function(img7) {
        incPressButton=img7.scale(.5).set({
            _uid:1,
            left: 3250,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });

       img7.on('selected', function() {
           incPress();
           canvas.deactivateAll();

        });
        canvas.add(img7).setActiveObject(img7);
    });

    fabric.Image.fromURL('decpress.png', function(img8) {
        decPressButton=img8.scale(.5).set({
            _uid:2,
            left: 3550,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });
       img8.on('selected', function() {
           decPress();
           canvas.deactivateAll();
       });

        canvas.add(img8).setActiveObject(img8);
    });


    fabric.Image.fromURL('gear.png', function (img9) {
        gear = img9.scale(.5).set({
            left: 3850,
            top: 700,
            lockMovementX: true,
            lockMovementY: true,
            lockRotation: true,
            lockScalingX: true,
            lockScalingY: true,
            hasControls:false,
            hasBorders:false,
            originX: 'center',
            originY: 'center',
            visible: true
        });

        canvas.add(gear);
        //.setActiveObject(gear);

        gear.on('selected', function() {
            gear.setVisible(false);
            users.setVisible(false);
            menuText.setVisible(false);
            menuText2.setVisible(false);
            menuIndex=1;
            canvas.deactivateAll();
            settingMenu();

        });

    });

    fabric.Image.fromURL('user.png', function(img10) {
                users= img10.scale(1).set({
                    _uid:1,
                    left: 3375,
                    top: 700, lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                canvas.add(users);

                users.on("selected", function() {
                    if (menuIndex == 0) {
                        menuIndex = 4;
                        gear.visible = false;
                        users.visible = false;
                        menuText.visible = false;
                        userIndex=0;
                        canvas.deactivateAll();
                        userMenu();
                    }
                    /*else if(menuIndex==4){
                     userProfile();
                     }*/

                });

            }
    );

    fabric.Image.fromURL('user.png', function(img11) {
                users2= img11.scale(1).set({
                    _uid:1,
                    left: 3655,
                    top: 700, lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: false
                });
        canvas.add(users2);
        users2.on("selected", function() {
                    menuIndex = 5;
                    nextArrow.visible=false;
                    prevArrow.visible=false;
                    users2.visible = false;
                    button6.visible = false;
                    plusText.visible = false;
                    canvas.deactivateAll();
                    userProfile();});
    });

    function createShowerScreen(){
        menuScreen = new fabric.Rect({
            left: 1635,
            top: 325,
            originX: 'center',
            originY: 'center',
            fill: 'black',
            stroke: 'black',
            width: 450,
            height: 300,
            evented:false,
            angle: 0
        });

        menuScreen.lockMovementX = true;
        menuScreen.lockMovementY = true;
        canvas.deactivateAll();

    }

    function menu1() {
        menuText.setVisible(true);
        menuText.text = languages[lIndex][2];
        menuText2.setVisible(true);
        menuText2.text = languages[lIndex][1];
        canvas.deactivateAll();
        }

    function settingMenu(){

        back.setVisible(true);

        menuText3.setVisible(true);
        menuText3.setText(languages[lIndex][3]);
        menuText3.bringToFront();

        menuText4.setVisible(true);
        menuText4.setText(languages[lIndex][4]);
        menuText4.bringToFront();

        button.setVisible(true);
        button2.setVisible(true);





        menuScreen.lockMovementX = true;
        menuScreen.lockMovementY = true;
        canvas.deactivateAll();

    }

    function userType(){
        if(isChild==false){
            userTypeText.text = languages[lIndex][10]
        }
        else{
            userTypeText.text = languages[lIndex][11]
        }
        canvas.deactivateAll();
    }
    function langSettings(){
        nextArrow.visible=true;
        prevArrow.visible=true;
        nextLang = 0;
        menuText3.setText(languages[1][0]);
        menuText4.setText(languages[0][0]);
        canvas.deactivateAll();
    }

    function tempSettings(){

        menuText3.setText("Celsius");
        menuText4.setText("Fahrenheit");
    }
    button.on('selected',function(){
        if(menuIndex==1){
            menuIndex=3;
            canvas.deactivateAll();
            tempSettings();
        }
        else if(menuIndex==2&&nextLang==0){
            lIndex=0;
            menuIndex=1;
            nextArrow.visible=false;
            prevArrow.visible=false;
            canvas.deactivateAll();
            settingMenu()
        }
        else if(menuIndex==3){
            tempIndex = 0;
            menuIndex=1;
            tempText.text = temperature + tempType[tempIndex];
            canvas.deactivateAll();
            settingMenu();
        }

    });
    button2.on('selected', function() {
        if(menuIndex==1) {
            menuIndex = 2;
            canvas.deactivateAll();
            langSettings();
        }
        else if(menuIndex==2&&nextLang==0){
            lIndex=1;
            menuIndex=1;
            nextArrow.visible=false;
            prevArrow.visible=false;
            canvas.deactivateAll();
            settingMenu()
        }
        else if(menuIndex==3){
            tempIndex = 1;
            menuIndex=1;
            if(tempIndex==1&&temperature!=0){

                var celsius = (temperature-32)*5/9;
                celsius = Math.floor(celsius);
                tempText.text=celsius.toString()+tempType[tempIndex];
            }
            else{
                tempText.text=temperature.toString()+tempType[tempIndex];
            }
            canvas.deactivateAll();
            settingMenu();
        }
    });

    button3.on('selected',function(){
        if(menuIndex==5){
            if(isSet==false){
                temperature = profiles[userIndex].pref[prefIndex].temp;
                pressure = profiles[userIndex].pref[prefIndex].press;
                if(profiles[userIndex].pref[prefIndex].bath==false){
                    diverter = true;
                    //isBath = false;
                }
                else{
                    diverter = false;
                    isBath = true;
                }
                divButton();
                //setSettings();
                //waterFlow();
                button3.fill='blue';
                isSet=true;
                canvas.deactivateAll();
            }
            else{
                temperature = 0;
                pressure = 0;
                waterFlow();
                button3.fill='grey';
                isSet=false;
                canvas.deactivateAll();
            }

        }
        else if(menuIndex==4){
            menuIndex=6
            users2.visible=false;
            nextArrow.visible=false;
            prevArrow.visible=false;
            button6.visible=false;
            plusText.visible = false;
            canvas.deactivateAll();
            setupProfileMenu();
        }
        else if ( menuIndex==6){
            profiles[userIndex].name = menuText8.text;
            profiles[userIndex].pref[prefIndex].bath = diverter;
            profiles[userIndex].pref[prefIndex].temp = temperature;
            profiles[userIndex].pref[prefIndex].isChild = isChild;
            profiles[userIndex].pref[prefIndex].press = pressure;
            profiles[userIndex].pref[prefIndex].lang = lIndex;
            button4.visible=false;
            prevArrow.Visible = true;
            nextArrow.visible = true;
            users2.visible = true;
            nextArrow2.visible=false;
            prevArrow2.visible=false;
            menuText.visible = false;
            menuText5.visible = false;
            menuText6.visible = false;
            menuText7.visible = false;
            menuText8.visible = false;
            tempText2.visible = false;
            pressText2.visible = false;
            menuText.top = 900;
            menuText.left = 3875;
            menuText.fontSize = 40;
            userTypeText.visible = false;
            usageText.visible = false;
            menuIndex=4;
            canvas.deactivateAll();
            userMenu();
        }
    })

    button4.on('selected',function(){
        if(isChild==true){
            button4.fill = 'grey';
            isChild=false;
        }
        else{
            button4.fill = 'green';
            isChild=true;
        }
        canvas.deactivateAll();
        userType()
    })

    button6.on('selected',function(){
        var prefences = [];
        var index = profiles.length;
        profiles.push({name: "User", id: (index+1), pref: prefences});
        for (j = 0; j < 5; j++) {
            profiles[index].pref.push({temp: 0, isChild: false, bath: false, press: 0, lang: 0});
        }
        userIndex = profiles.length-1;
        menuText2.text = languages[lIndex][5]+profiles[userIndex].id;
        canvas.deactivateAll();

    })


    function userMenu(){

        back.visible = true;
        nextArrow.visible = true;
        prevArrow.visible = true;
        button3.visible = true;
        button6.visible = true;
        plusText.visible = true;
        runText.visible = true;
        menuText2.left=3655;
        menuText2.top = 400;
        users2.visible = true;
        runText.text = languages[lIndex][14];
       if(profiles[userIndex].name!="User") {
            menuText2.text = profiles[userIndex].name;
        }
        else {
            menuText2.text = languages[lIndex][5]+profiles[userIndex].id;
        }
        canvas.deactivateAll();
        //users.left = 3655;

    }


    function userProfile(){
        menuText.visible = true;
        menuText5.visible = true;
        menuText6.visible = true;
        menuText7.visible = true;
        pressText2.visible = true;
        tempText2.visible = true;
        usageText.visible = true;
        userTypeText.visible = true;
        nextArrow2.visible = true;
        prevArrow2.visible = true;
        menuText.top= 500;
        menuText.left= 3300;
        menuText.fontSize = 34;
        menuText.text= languages[lIndex][9];
        menuText5.text = languages[lIndex][8];
        menuText6.text = languages[lIndex][7];
        menuText7.text = languages[lIndex][6];
        runText.text = languages[lIndex][15];
        prefIndex =0;

        if(profiles[userIndex].name!="User") {
            menuText8.text = profiles[userIndex].name;
        }
        else {
            menuText8.text = languages[lIndex][5]+profiles[userIndex].id;
        }

        menuText2.text = (prefIndex+1).toString();



        if(profiles[userIndex].pref[prefIndex].isChild==false){
            userTypeText.text = languages[lIndex][10];
        }
        else{
            userTypeText.text = languages[lIndex][11];
        }

        if(profiles[userIndex].pref[prefIndex].bath==false){
            usageText.text = languages[lIndex][12];
        }
        else{
            usageText.text = languages[lIndex][13];
        }

        tempText2.text = profiles[userIndex].pref[prefIndex].temp + tempType[tempIndex];
        pressText2.text = profiles[userIndex].pref[prefIndex].press +"psi";
        canvas.deactivateAll();

    }
    function setupProfileMenu(){
        menuIndex=6;
        menuText.visible = true;
        menuText5.visible = true;
        menuText6.visible = true;
        menuText7.visible = true;
        menuText8.visible = true;
        pressText2.visible = true;
        tempText2.visible = true;
        usageText.visible = true;
        userTypeText.visible = true;
        nextArrow2.visible = true;
        prevArrow2.visible = true;
        button4.visible = true;
        menuText8.enterEditing();
        menuText8.hiddenTextarea.focus();
        prefIndex = 0;
        menuText2.text = (prefIndex+1).toString();
        isChild = profiles[userIndex].pref[prefIndex].isChild;
        menuText.top= 500;
        menuText.left= 3300;
        menuText2.fill = 'green';
        menuText2.left = 3800;
        menuText.fontSize = 34;
        menuText.text= languages[lIndex][9];
        menuText5.text = languages[lIndex][8];
        menuText6.text = languages[lIndex][7];
        menuText7.text = languages[lIndex][6];
        runText.text = languages[lIndex][16];
        tempText2.text = profiles[userIndex].pref[prefIndex].temp + tempType[tempIndex];
        pressText2.text = profiles[userIndex].pref[prefIndex].press +"psi";
        canvas.deactivateAll();

    }

    setInterval(incWater,1000);

    createShowerScreen();
    menu1();

    function mainControls(){
        if(isBath==true) {
            var temp;
            fabric.Image.fromURL(temperature + png, function (img) {
                temp = img.scale(.5).set({
                    left: 3900,
                    top: 1550,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(tempDisp);
                tempDisp = temp;
                canvas.add(img).setActiveObject(img);
                tempText.bringToFront();
                degree.bringToFront();
            });
            fabric.Image.fromURL('p'+pressure+png, function(img6) {
                temp=img6.scale(.5).set({
                    left: 3400,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(pressDisp);
                pressDisp = temp;
                canvas.add(img6).setActiveObject(img6);
                pressText.text=pressure.toString();
                pressText.bringToFront();
                psi.bringToFront();

            });
            fabric.Image.fromURL('diverter1'+png, function(img4) {
                var temp=img4.scale(.4).set({
                    left: 3650,
                    top: 1800,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(divButt);
                divButt = temp;
                canvas.add(divButt);
            });
            fabric.Image.fromURL('diverter'+divIndex+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1800,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);

                img5.on('selected',function(){
                    divButton();
                })

                img5.bringToFront();
                divButt2 = temp;
            });

            fabric.Image.fromURL('L'+waterLevel+png, function(img6) {
                var temp=img6.scale(.5).set({
                    left: 3950,
                    top: 1850,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(waterMonitor);
                waterMonitor = temp;
                canvas.add(waterMonitor).setActiveObject(waterMonitor);
            });


            fabric.Image.fromURL('cold-arrow.png', function(img3) {
                temp=img3.scale(.5).set({
                    left: 4050,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                temp.on('selected', function() {
                    tempDec();
                    canvas.deactivateAll();
                });
                canvas.remove(coldArrow);
                coldArrow = temp;
                canvas.add(coldArrow);
                tempText.bringToFront();

            });

            fabric.Image.fromURL('hot-arrow.png', function(img2) {
                temp=img2.scale(.5).set({
                    _uid:1,
                    left: 3750,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                temp.on('selected', function() {
                    tempInc();
                    canvas.deactivateAll();
                });
                canvas.remove(hotArrow);
                hotArrow = temp;
                canvas.add(hotArrow);
                tempText.bringToFront();

            });


            fabric.Image.fromURL('incPress.png', function(img7) {
                temp=img7.scale(.5).set({
                    _uid:1,
                    left: 3250,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                temp.on('selected', function() {
                    incPress();
                    canvas.deactivateAll();

                });
                canvas.remove(incPressButton);
                incPressButton = temp;
                canvas.add(incPressButton);
                tempText.bringToFront();
            });

            fabric.Image.fromURL('decpress.png', function(img8) {
                temp=img8.scale(.5).set({
                    _uid:2,
                    left: 3550,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                temp.on('selected', function() {
                    decPress();
                    canvas.deactivateAll();
                });

                canvas.remove(decPressButton);
                decPressButton = temp;
                canvas.add(decPressButton);
                tempText.bringToFront();
            });

            tempText.top=1500;
            pressText.top=1500;
            psi.top=1500;
            degree.top=1460;


        }
        else {
            console.log("testing");
            var temp;
            fabric.Image.fromURL(temperature + png, function (img) {
                temp = img.scale(.5).set({
                    left: 3900,
                    top: 1250,
                    lockMovementX: true,
                    lockMovementY: true,
                    lockRotation: true,
                    lockScalingX: true,
                    lockScalingY: true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(tempDisp);
                tempDisp = temp;
                canvas.add(img).setActiveObject(img);
                tempText.bringToFront();
                degree.bringToFront();
            });

            fabric.Image.fromURL('p'+pressure+png, function(img6) {
                temp=img6.scale(.5).set({
                    left: 3400,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(pressDisp);
                pressDisp = temp;
                canvas.add(img6).setActiveObject(img6);
                pressText.text=pressure.toString();
                pressText.bringToFront();
                psi.bringToFront();


            });
            fabric.Image.fromURL('diverter1'+png, function(img4) {
                var temp=img4.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(divButt);
                divButt = temp;
                canvas.add(divButt);
            });

            fabric.Image.fromURL('diverter'+divIndex+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);

                img5.on('selected',function(){
                    divButton();
                })

                img5.bringToFront();
                divButt2 = temp;
            });

            fabric.Image.fromURL('L'+waterLevel+png, function(img6) {
                var temp=img6.scale(.5).set({
                    left: 3950,
                    top: 1550,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.remove(waterMonitor);
                waterMonitor = temp;
                canvas.add(waterMonitor).setActiveObject(waterMonitor);
            });

            fabric.Image.fromURL('cold-arrow.png', function(img3) {
                temp=img3.scale(.5).set({
                    _uid:2,
                    left: 4050,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    hasControls:false,
                    hasBorders:false,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                temp.on('selected', function() {
                    tempDec()
                    canvas.deactivateAll();
                });


                canvas.remove(coldArrow);
                coldArrow = temp;
                canvas.add(coldArrow);
            });

            fabric.Image.fromURL('hot-arrow.png', function(img2) {
                temp=img2.scale(.5).set({
                    _uid:1,
                    left: 3750,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                temp.on('selected', function() {
                    tempInc();
                    canvas.deactivateAll();
                });
                canvas.remove(hotArrow);
                hotArrow = temp;
                canvas.add(hotArrow);
                tempText.bringToFront();

            });

            fabric.Image.fromURL('incPress.png', function(img7) {
                temp=img7.scale(.5).set({
                    _uid:1,
                    left: 3250,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                temp.on('selected', function() {
                    incPress();
                    canvas.deactivateAll();

                });
                canvas.remove(incPressButton);
                incPressButton = temp;
                canvas.add(incPressButton);
                tempText.bringToFront();
            });

            fabric.Image.fromURL('decpress.png', function(img8) {
                temp=img8.scale(.5).set({
                    _uid:2,
                    left: 3550,
                    top: 1250,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    hasControls:false,
                    hasBorders:false,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                temp.on('selected', function() {
                    decPress();
                    canvas.deactivateAll();
                });

                canvas.remove(decPressButton);
                decPressButton = temp;
                canvas.add(decPressButton);
                tempText.bringToFront();
            });




            tempText.top=1200;
            pressText.top=1200;
            psi.top=1200;
            degree.top=1170;
        }


    }




//----------------------------------End of My Code-----------------------------------------------------------------
//----------------------------------------------------------------
var waterTemp = 0;

waterControl.on('selected', function() {
  //console.log('selected a rectangle');
  waterTemp = 1 - waterTemp;
  updateWaterTemp();
  canvas.deactivateAll(); // deselect everything
});

// as a quick test I could have a 'button' that changes colour when I press it


canvas.add(psi);
canvas.add(pressText);
canvas.add(tempText);
canvas.add(degree);
    canvas.add(menuScreen);
    canvas.add(menuText);
    canvas.add(menuText2);
    canvas.add(menuText3);
    canvas.add(menuText4);
    canvas.add(menuText5);
    canvas.add(menuText6);
    canvas.add(menuText7);
    canvas.add(menuText8).setActiveObject(menuText8);
    canvas.add(button);
    canvas.add(button2);
    canvas.add(button3);
    canvas.add(button4);
    canvas.add(button6);
    canvas.add(plusText);
    canvas.add(runText);
    canvas.add(saveText);
    canvas.add(nextArrow);
    canvas.add(nextArrow2);
    canvas.add(prevArrow);
    canvas.add(prevArrow2);
    canvas.add(tempText2);
    canvas.add(pressText2);
    canvas.add(usageText);
    canvas.add(userTypeText);
    canvas.add(back);

/*canvas.add(menuText[0]);
canvas.add(menuText[1]);*/






// code adapted from http://jsfiddle.net/tornado1979/39up3jcm/
function zoomAll(SCALE_FACTOR) {

      var objects = canvas.getObjects();
      for (var i in objects) {
          var scaleX = objects[i].scaleX;
          var scaleY = objects[i].scaleY;
          var left = objects[i].left;
          var top = objects[i].top;

          var tempScaleX = scaleX * SCALE_FACTOR;
          var tempScaleY = scaleY * SCALE_FACTOR;
          var tempLeft = left * SCALE_FACTOR;
          var tempTop = top * SCALE_FACTOR;

          objects[i].scaleX = tempScaleX;
          objects[i].scaleY = tempScaleY;
          objects[i].left = tempLeft;
          objects[i].top = tempTop;

          objects[i].setCoords();
      }
  
     
      canvas.renderAll();
  }


zoomAll(canvas.height / localHeight);




})();




</script>
		
</head>
  
</html>