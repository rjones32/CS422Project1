<!DOCTYPE html>    
<head>
    <meta charset="utf-8">
    <title>fabric.js project template</title>
	
	<!-- Get version 1.5.0 of Fabric.js from CDN -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.5.0/fabric.min.js" ></script>
 

	 
<body>
		<!-- canvas tag for Fabric.js to draw into -->
		<canvas id="c" width="4140" height="2200" style="border:2px solid black;" ></canvas>

</body>
 
<script>

// within the code below I assume I am drawing into a 1860x990 box
// then I can scale the group to whatever size the final canvas is
// in this case 4140 x 2200 for the wall
// you should pick an appropriate local size and canvas size that are easy for you to work with

  var temperature = 0;
  var diverter = false;
  var pressure = 0;
  var waterLevel = 0;
  var isHot = false;
  var isCelsius = false;
  var tmpDisp = [];
  var profiles = [];
  var png = ".png";
  var tempType = "F";
  var tempDisp;
  var divButt;
  var divButt2;
  var hotArrow;
  var coldArrow;
  var pressDisp;
  var incPressButton;
  var decPressButton;
  var menu = [];
  var menuIndex = 0;
  var users;
  var back;
  var gear;
  var menuScreen;
  var menuText;
  var menuText2;
  var menuTemp;
  var menuLang;
  var langSetting, Langsetting2;
  var languages = [];
  var lIndex = 0;
  var button,button2;

  for(i=0;i<2;i++){
      languages[i] = [];
      for(j=0;j<5;j++){
          languages[i][j]="a";
      }
  }

  languages[0][0]="English";
  languages[0][1]="Users";
  languages[0][2]="Settings";
  languages[0][3]="Languages";
  languages[0][4]="Temperature Type";
  languages[1][0]="français";
  languages[1][1]="utilisateurs";
  languages[1][2]="paramètres";
  languages[1][3]="Langues";
  languages[1][4]="Température Type";




(function() {

  var localHeight = 990;
  var localWidth = 1860;

  var canvas = this.__canvas = new fabric.Canvas('c');

  canvas.backgroundColor = "#5555F5"; // background blue to help find it
  //fabric.Object.prototype.transparentCorners = false;

  canvas.renderOnAddRemove=false;

/*
  canvas.on('mouse:over', function(e) {
    console.log(e.target);
    //canvas.renderAll();
  });

  canvas.on('mouse:out', function(e) {
    console.log(e.target);
    //canvas.renderAll();
  });
*/

var backWall = new fabric.Rect({
  left: 0,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 450,
  height: localHeight,
  angle: 0
});
backWall.hasControls = backWall.hasBorders = false;
backWall.lockMovementX = backWall.lockMovementY = true;

var sideWall = new fabric.Rect({
  left: 450,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 960,
  height: localHeight,
  angle: 0
});
sideWall.hasControls = sideWall.hasBorders = false;
sideWall.lockMovementX = sideWall.lockMovementY = true;

var frontWall = new fabric.Rect({
  left: 1410,
  top: 0,
  fill: 'white',
  stroke: 'black',
  width: 450,
  height: localHeight,
  angle: 0
});
frontWall.hasControls = frontWall.hasBorders = false;
frontWall.lockMovementX = frontWall.lockMovementY = true;

var bathSpout = new fabric.Rect({
  left: 1635,
  top: 950,
  originX: 'center',
  originY: 'center',
  fill: 'grey',
  stroke: 'black',
  width: 60,
  height: 30,
  angle: 0
});

bathSpout.hasControls = bathSpout.hasBorders = false;
bathSpout.lockMovementX = bathSpout.lockMovementY = true;

// this lets me 'select' it but I cant keep clicking on it more than once


var showerHead = new fabric.Circle({
  radius: 20, fill: 'black', left: 1635, top: 100,   originX: 'center',
  originY: 'center'
});


    canvas.add(backWall);
    canvas.add(sideWall);
    canvas.add(frontWall);
    canvas.add(showerHead);
    canvas.add(bathSpout);




var tempText = new fabric.Text('0F', { left: 1755, top: 545, fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
  originY: 'top',});

tempText.hasControls = tempText.hasBorders = false;
tempText.lockMovementX = tempText.lockMovementY = false;
tempText.selectable = false;

var degree = new fabric.Text('o', { left: 1770, top: 530, fontFamily: 'Arial', fontSize: 20, fontWeight: 'italic', originX: 'top', originY: 'top',});

    tempText.hasControls = tempText.hasBorders = false;
    tempText.lockMovementX = tempText.lockMovementY = false;
    tempText.selectable = false;

    var pressText = new fabric.Text('0', { left: 1525, top: 545, fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',});

    pressText.hasControls = pressText.hasBorders = false;
    pressText.lockMovementX = pressText.lockMovementY = false;
    pressText.selectable = false;


    var psi = new fabric.Text('psi', { left: 1555, top: 545, fontFamily: 'Arial', fontSize: 20, fontWeight: 'italic', originX: 'top',
        originY: 'top',});

    psi.hasControls = psi.hasBorders = false;
    psi.lockMovementX = psi.lockMovementY = false;
    psi.selectable = false;



    //tempText.selectable = false;

var waterControl = new fabric.Circle({
  left: 1500,
  top: 90,
  originX: 'center',
  originY: 'center',
  fill: 'grey',
  radius: 50
});



//-------------------------------------------------------------------------------------------------------------------
//---------------------------------------------------My code---------------------------------------------------------
  /*  var hotArrow = new fabric.Rect({
        left: 1600,
        top: 565,
        originX: 'center',
        originY: 'center',
        fill:'white',
        height: 150,
        width: 100
    })
    var coldArrow = new fabric.Rect({
        left: 1725,
        top: 565,
        originX: 'center',
        originY: 'center',
        fill:'white',
        height: 150,
        width: 100
    })
    hotArrow.lockMovementX = hotArrow.lockMovementY = true;
    coldArrow.lockMovementX=coldArrow.lockMovementY = true;*/

    function tempInc(){

        var temp;

        if(temperature==0){
            temperature=70;
        }
        else if(temperature==65){
            temperature=0;
        }
        else if (temperature>=95){
            temperature=95;
        }
        else{
            temperature = temperature + 5;
        }
        console.log("Increasing temperature");


        fabric.Image.fromURL(temperature+png, function(img) {
            temp=img.scale(.5).set({
                left: 3900,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(tempDisp);
            tempDisp = temp;
            canvas.add(img).setActiveObject(img);
            tempText.bringToFront();
            degree.bringToFront();
        });
        tempText.text=temperature.toString()+tempType;

    }


    function tempDec(){
        var temp;

        if(temperature==0){
            temperature=65;
        }
        else if(temperature==70){
            temperature = 0;
        }
        else if(temperature<=40){
            temperature = 40;
        }
        else{
            temperature = temperature - 5;
        }
        console.log("Deceasing Temperature");

        fabric.Image.fromURL(temperature+png, function(img) {
            temp=img.scale(.5).set({
                left: 3900,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(tempDisp);
            tempDisp = temp;

            canvas.add(img).setActiveObject(img);
            tempText.bringToFront();
            tempText.bringToFront();
            degree.bringToFront();
            tempText.text=temperature.toString()+tempType;


        });


    }

    function divButton(){
        var temp;

        if(diverter==false){
            console.log("diverter is false");
            fabric.Image.fromURL('diverter3'+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    /*lockRotation:true,
                     lockScalingX:true,
                     lockScalingY:true,*/
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);

                img5.on('selected',function(){
                    divButton();

                })

                img5.bringToFront();
                divButt2 = temp;
                diverter = true;

            });

        }
        else if(diverter==true){

            console.log("diverter is true");
            fabric.Image.fromURL('diverter2'+png, function(img5) {
                temp=img5.scale(.4).set({
                    left: 3650,
                    top: 1500,
                    hasControls:false,
                    hasRotatingPoint:false,
                    lockMovementX:true,
                    lockMovementY:true,
                    /*lockRotation:true,
                     lockScalingX:true,
                     lockScalingY:true,*/

                    originX: 'center',
                    originY: 'center',
                    visible: true
                });
                canvas.add(img5);
                canvas.remove(divButt2);
                img5.on('selected',function(){
                    divButton();

                })
                img5.bringToFront();
                divButt2 = temp;
                diverter = false;

            });
        }
    }

    function incPress(){

        var temp;

        if(pressure<25){
            pressure=pressure+5;
        }
        else{
            pressure = 25;
        }
        console.log("Increasing pressure");


        fabric.Image.fromURL('p'+pressure+png, function(img6) {
            temp=img6.scale(.5).set({
                left: 3400,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(pressDisp);
            pressDisp = temp;
            canvas.add(img6).setActiveObject(img6);
            pressText.text=pressure.toString();
            pressText.bringToFront();
            psi.bringToFront();

        });


    }


    function decPress(){
        var temp;

        if(pressure>0){
            pressure=pressure-5;
        }
        else {
            pressure = 0;
        }

        console.log("Deceasing pressure");

        fabric.Image.fromURL('p'+pressure+png, function(img6) {
            temp=img6.scale(.5).set({
                left: 3400,
                top: 1250,
                lockMovementX:true,
                lockMovementY:true,
                lockRotation:true,
                lockScalingX:true,
                lockScalingY:true,
                originX: 'center',
                originY: 'center',
                visible: true
            });
            canvas.remove(pressDisp);
            pressDisp = temp;

            canvas.add(img6).setActiveObject(img6);
            pressText.bringToFront();
            psi.bringToFront();
            pressText.text=pressure.toString();



        });


    }




   /* hotArrow.on('selected', function() {
        console.log('selected hotArrow');
        tempInc();
        canvas.deactivateAll(); // deselect everything
    });

    coldArrow.on('selected', function() {
        console.log('selected hotArrow');
        tempDec();
        canvas.deactivateAll(); // deselect everything
    });*/






    /*
     arrow2.on('selected', function() {
     //console.log('selected a rectangle');
     tempDec();
     canvas.deactivateAll(); // deselect everything
     });*/



//-----------------------------------------------------------------------------------------------------------------
//----------------------------------Menu text------------------------------------------------------------------------



    button = new fabric.Rect({
        left: 1590,
        top: 300,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 350,
        height: 50,
        angle: 0,
        visible:false

    });


    button.lockMovementX= button.lockMovementY = true;


    button2 = new fabric.Rect({
        left: 1590,
        top: 370,
        originX: 'center',
        originY: 'center',
        fill: 'grey',
        stroke: 'black',
        width: 350,
        height: 50,
        angle: 0,
        visible:false
    });
    button2.lockMovementX=button2.lockMovementY=true;



    menuLang= new fabric.Text(languages[lIndex][3], {left:1525, top:340,fill:'white', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false, evented:true});

    menuLang.hasControls = menuLang.hasBorders = false;
    menuLang.lockMovementX = menuLang.lockMovementY = true;

    menuLang.on('selected', function() {
        langSettings();

    });


    menuTemp = new fabric.Text(languages[lIndex][4], {left:1575,top:280,fontFamily: 'Arial',fill:'white', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuTemp.hasControls = menuTemp.hasBorders = false;
    menuTemp.lockMovementX = menuTemp.lockMovementY = true;


    langText= new fabric.Text(languages[lIndex][0], {left:1525, top:340,fill:'white', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    langText.hasControls = langText.hasBorders = false;
    langText.lockMovementX = langText.lockMovementY = true;

    langText.on('selected', function() {
        langSettings();

    });


    langText2= new fabric.Text(languages[lIndex][0], {left:1525, top:340,fill:'white', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    langText2.hasControls = langText2.hasBorders = false;
    langText2.lockMovementX = langText2.lockMovementY = true;

    langText2.on('selected', function() {
        langSettings();

    });



    menuText = new fabric.Text(languages[lIndex][1], {left:1725, top:400,fill:'green', fontFamily: 'Arial', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText.hasControls = menuText.hasBorders = true;
    menuText.lockMovementX = menuText.lockMovementY = true;


    menuText2 = new fabric.Text(languages[lIndex][2], {left:1525,top:400,fontFamily: 'Arial',fill:'green', fontSize: 40, fontWeight: 'italic', originX: 'top',
        originY: 'top',visible:false});

    menuText2.hasControls = menuText2.hasBorders = true;
    menuText2.lockMovementX = menuText2.lockMovementY = true;


//-----------------------------------------------------------------------------------------------------------------
//----------------------------------My Code------------------------------------------------------------------------

    fabric.Image.fromURL('backarrow.png', function(img11) {
                back = img11.scale(.75).set({
                    left: 3375,
                    top: 470,
                    lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: false
                });
                canvas.add(img11).setActiveObject(img11);
            }
    );



    fabric.Image.fromURL('0'+png, function(img) {
        tempDisp=img.scale(.5).set({
            left: 3900,
            top: 1250,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:false,
            lockMovementY:false,
            /*lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,*/
            originX: 'center',
            originY: 'center',
            visible: true
        });
         canvas.add(img);
        tempText.bringToFront();
        degree.bringToFront();
    });






   fabric.Image.fromURL('hot-arrow.png', function(img2) {
        img2.scale(.5).set({
            _uid:1,
            left: 3750,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });

       img2.on('selected', function() {
           tempInc();

        });
        canvas.add(img2).setActiveObject(img2);
       tempText.bringToFront();

    });

    fabric.Image.fromURL('cold-arrow.png', function(img3) {
        img3.scale(.5).set({
            _uid:2,
            left: 4050,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });
       img3.on('selected', function() {
           tempDec()});

        canvas.add(img3).setActiveObject(img3);
    });

    fabric.Image.fromURL('diverter1'+png, function(img4) {
        divButt=img4.scale(.4).set({
            left: 3650,
            top: 1500,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            /*lockRotation:true,
             lockScalingX:true,
             lockScalingY:true,*/
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img4);
    });

    fabric.Image.fromURL('diverter2'+png, function(img5) {
        divButt2=img5.scale(.4).set({
            left: 3650,
            top: 1500,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            /*lockRotation:true,
             lockScalingX:true,
             lockScalingY:true,*/
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img5);
        img5.bringToFront();
        img5.on('selected',function(){
            divButton();

        })
    });


    fabric.Image.fromURL('p0'+png, function(img6) {
        pressDisp=img6.scale(.5).set({
            left: 3400,
            top: 1250,
            hasControls:false,
            hasRotatingPoint:false,
            lockMovementX:true,
            lockMovementY:true,
            /*lockRotation:true,
             lockScalingX:true,
             lockScalingY:true,*/
            originX: 'center',
            originY: 'center',
            visible: true
        });
        canvas.add(img6).setActiveObject(img6);
       pressText.bringToFront();
        psi.bringToFront();

    });






    fabric.Image.fromURL('incPress.png', function(img7) {
        incPressButton=img7.scale(.5).set({
            _uid:1,
            left: 3250,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });

       img7.on('selected', function() {
           incPress();

        });
        canvas.add(img7).setActiveObject(img7);


    });

    fabric.Image.fromURL('decpress.png', function(img8) {
        decPressButton=img8.scale(.5).set({
            _uid:2,
            left: 3550,
            top: 1250,
            lockMovementX:true,
            lockMovementY:true,
            lockRotation:true,
            lockScalingX:true,
            lockScalingY:true,
            originX: 'center',
            originY: 'center',
            visible: true
        });
       img8.on('selected', function() {
           decPress();
       });

        canvas.add(img8).setActiveObject(img8);
    });


    fabric.Image.fromURL('gear.png', function (img9) {
        gear = img9.scale(.5).set({
            left: 3850,
            top: 700,
            lockMovementX: true,
            lockMovementY: true,
            lockRotation: true,
            lockScalingX: true,
            lockScalingY: true,
            originX: 'center',
            originY: 'center',
            visible: true
        });

        canvas.add(gear).setActiveObject(gear);

        gear.on('selected', function() {
            gear.setVisible(false);
            users.setVisible(false);
            menuText.setVisible(false);
            menuText2.setVisible(false);
            settingMenu();

        });

    });

    fabric.Image.fromURL('user.png', function(img10) {
                users= img10.scale(1).set({
                    _uid:1,
                    left: 3375,
                    top: 700, lockMovementX:true,
                    lockMovementY:true,
                    lockRotation:true,
                    lockScalingX:true,
                    lockScalingY:true,
                    originX: 'center',
                    originY: 'center',
                    visible: true
                });

                /* img7.on('selected', function() {
                 incPress();

                 });*/
                canvas.add(users).setActiveObject(users);



            }
    );


    function createShowerScreen(){
        menuScreen = new fabric.Rect({
            left: 1635,
            top: 325,
            originX: 'center',
            originY: 'center',
            fill: 'black',
            stroke: 'black',
            width: 450,
            height: 300,
            angle: 0
        });

        menuScreen.lockMovementX = true;
        menuScreen.lockMovementY = true;

    }

    function menu1() {
        menuText.setVisible(true);
        menuText2.setVisible(true);
        }

    function settingMenu(){


        back.setVisible(true);
        menuLang.setVisible(true);
        menuLang.bringToFront();
        menuTemp.setVisible(true);
        menuTemp.bringToFront();
        button.setVisible(true);
        button2.setVisible(true);





        menuScreen.lockMovementX = true;
        menuScreen.lockMovementY = true;

        back.on('selected', function() {
            back.setVisible(false);
            gear.setVisible(true);
            users.setVisible(true);
            menuTemp.setVisible(false);
            menuLang.setVisible(false);
            button.setVisible(false);
            button2.setVisible(false);
            menu1();
        });

    }
    function langSettings(){

        langText.setVisible(true);
        langText2.setVisible(true);
    }


    createShowerScreen();
    menu1();


//----------------------------------End of My Code-----------------------------------------------------------------
//----------------------------------------------------------------
var waterTemp = 0;

function updateWaterTemp() {
if (waterTemp > 0.5) {
  waterControl.fill = 'red';
  tempText.text = "hot";
  } 
else {
  waterControl.fill = 'aqua';
  tempText.text = "cold";
}
}



waterControl.on('selected', function() {
  //console.log('selected a rectangle');
  waterTemp = 1 - waterTemp;
  updateWaterTemp();
  canvas.deactivateAll(); // deselect everything
});

// as a quick test I could have a 'button' that changes colour when I press it


canvas.add(psi);
canvas.add(pressText);
canvas.add(tempText);
canvas.add(degree);
    canvas.add(menuScreen);
    canvas.add(menuText);
    canvas.add(menuText2);
    canvas.add(menuTemp);
    canvas.add(menuLang);
    canvas.add(button);
    canvas.add(button2);

/*canvas.add(menuText[0]);
canvas.add(menuText[1]);*/






// code adapted from http://jsfiddle.net/tornado1979/39up3jcm/
function zoomAll(SCALE_FACTOR) {

      var objects = canvas.getObjects();
      for (var i in objects) {
          var scaleX = objects[i].scaleX;
          var scaleY = objects[i].scaleY;
          var left = objects[i].left;
          var top = objects[i].top;

          var tempScaleX = scaleX * SCALE_FACTOR;
          var tempScaleY = scaleY * SCALE_FACTOR;
          var tempLeft = left * SCALE_FACTOR;
          var tempTop = top * SCALE_FACTOR;

          objects[i].scaleX = tempScaleX;
          objects[i].scaleY = tempScaleY;
          objects[i].left = tempLeft;
          objects[i].top = tempTop;

          objects[i].setCoords();
      }
  
     
      canvas.renderAll();
  }


zoomAll(canvas.height / localHeight);




})();




</script>
		
</head>
  
</html>